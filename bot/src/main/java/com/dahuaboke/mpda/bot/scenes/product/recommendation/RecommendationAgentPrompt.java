package com.dahuaboke.mpda.bot.scenes.product.recommendation;


import com.dahuaboke.mpda.bot.scenes.product.AbstractProductAgentPrompt;
import org.springframework.stereotype.Component;

import java.util.Map;

/**
 * auth: dahua
 * time: 2025/8/22 14:47
 */
@Component
public class RecommendationAgentPrompt extends AbstractProductAgentPrompt {

    public RecommendationAgentPrompt() {
        this.promptMap = Map.of(
                "guide", """
                            1.分析用户问题,判断是否需要调用工具获取最新/详细数据
                            2.如果需要调用工具:
                                (1)需要分析工具所需参数，传入需要的参数
                                (2)如果不满足工具调用条件，需要引导用户补充。
                                最后调用以下工具： 根据年化利率/基金类型/月最大回撤率来查询匹配的产品信息
                            3.如果不需要调用工具,直接基于已有信息分析回答用户问题
                           
                        """
                , "tool", "。 根据工具执行后的结果,需要遵循以下规则" +
                        "1. 对于基金的任何信息都需要在工具执行结果中，不可以进行胡乱编造，出现不存在的基金代码和基金信息。" +
                        "2. 工具返回的原始查询结果(如列表，实体类)，禁止直接呈现给用户；需要你自主整理，分析，优化为清晰易懂的MarkDown格式。如果没有返回任何结果,禁止胡编乱造。无需下述流程,直接返回。" +
                        "3. 如果工具返回条数大于5以上, 只给用户展示收益率从高到低的前5条数据" +
                        "4. 如果工具未返回任何结果, 无需考虑字段翻译,直接返回即可" +
                        "5. 对工具返回数据需要进行字段翻译,字段关系映射如下:" +
                        ""+ translatePrompt + """
                            如果是全量信息查询，则仅返回以下字段内容：
                                基金类型
                                基金代码
                                基金名称
                                基金管理人
                                基金托管人
                                基金经理
                                基金规模
                                收益率(动态展示周/月/三月/年收益率,取决于查询的时间周期)
                            如果是【配置】问题:
                                - 直接返回查询结果,模型基于工具返回的结果分析配置基金给用户
                            如果是【推荐】问题:
                                返回: 根据您的要求,我共找到XX款符合条件的基金。以下是为您按收益率从高到低排序的前XX个产品。如果这份列表不完全符合您的预期，您可以告诉我更具体的偏好，我能为您精准筛选，如: 指定基金公司或基金经理，设定您期望的收益率或最大回撤的具体区间。

                            如果工具未返回任何信息，直接回复：未找到匹配条件的基金，您可以提供期望的年化利率、具体的基金类型或可接受的最大回撤率吗？这些信息将帮助我们更精准地筛选出符合您需求的基金产品。
                        """);
        this.description = promptMap.get("guide");
    }


    String translatePrompt = """
                   以下是字段的名称和中文的对照翻译
                   \n
                    | 英文字段 | 中文描述 | 同义词 / 常用词 |
                    | :--- | :--- | :--- |
                    | fundCode | 基金代码 | 基金编码、产品代码、基金编号 |
                    | fundType | 基金类型 | 基金大类、基金品种类型、基金种类、基金属于哪一类 |
                    | fundFnm | 基金全称 | 基金名称、基金完整名称、产品全称（基金）、基金全名、基金的完整名字 |
                    | ivstStgyName | 主要投资策略 | 核心投资方法、基金投资策略、怎么投资的、投资思路、基金策略 |
                    | fundOprModeCd | 运作方式 | 运作模式、基金运行方式、基金怎么运作的、运作类型、基金是开放式还是封闭式 |
                    | performCmpBmkTxtDesc | 业绩比较基准 | 业绩基准、基金业绩对比基准、对比的业绩标准、业绩参考基准 |
                    | investTargetCode | 投资目标 | 投资宗旨、基金投资目的、基金的投资方向目标 |
                    | investScope | 投资范围 | 投资领域、基金可投资品种范围、基金能投什么、投资的品种/领域限制 |      
                    | assetNval | 期末基金资产净值 | 期末净值、报告期末基金资产净值、季末净值、基金期末资产价值、基金规模、规模、资产规模 | 
                    | psbcChremCphsFert | 基金运作综合费率（年化） | 年化综合费率、基金总运作成本率（年化）、年化总费率、一年的总运作费用率 |
                    | infdclNppSumm | 基金运作相关费用信息披露费 | 信息披露费用、运作信息公开费、信息披露成本、基金信息发布费用 |
                    | saleServFee | 基金运作相关费用销售服务费 | 销售服务费、运作销售费用、销售服务成本、给销售渠道的服务费 |
                    | fundTsfrt | 基金运作相关费用托管费 | 基金托管费、运作托管费用、托管服务费、基金托管成本 |
                    | auditFe | 基金运作相关费用审计费用 | 基金审计费、运作审计费用、审计服务费、基金审计成本 |
                    | afadjOthfe | 基金运作相关费用其他费用 | 其他运作费用、运作杂费、杂项费用、除管理费托管费外的运作费用 |
                    | excessMngFee | 基金运作相关费用管理费 | 基金管理费、运作管理费用、管理服务费、给管理人的费用 |
                    | rdmFert | 基金销售相关费用赎回费 | 赎回手续费、卖出基金费用、卖基金的手续费、赎回时收的费 |
                    | fundAplypchsFee | 基金销售相关费用申购费 | 申购手续费、购买基金费用、买基金的手续费、申购时收的费 |
                    | trusteePersName | 基金托管人 | 托管机构、基金托管银行 / 公司、托管方、负责托管的银行 / 公司 |
                    | competBgnTime | 基金经理证券从业日期 | 基金经理证券从业起始日、管理人进入证券行业日期、经理开始做证券的时间、证券从业开始日 |
                    | engageYearNum | 基金经理证券从业年限 | 基金经理从业时长、管理人证券行业工作年数、经理做证券多久了、证券从业年限 |
                    | engagePersonDesc | 基金经理说明 | 基金经理介绍、管理人情况说明、经理背景介绍、基金经理的相关说明 |
                    | offcDt | 基金经理任职日期 | 基金经理管理本基金起始日、基金经理任职开始日、开始管这只基金的日期、接手本基金的时间、基金经理上任日期、管理人任职起始日、经理开始管这只基金的日期、任职开始日 |
                    | investMgrName | 基金经理名字 | 基金经理姓名、管理人姓名、负责该基金的经理名字、基金经理是谁 |
                    | relatBgnTime | 基金经理开始担任本基金基金经理的日期 | 基金经理管理本基金起始日、基金经理任职开始日、开始管这只基金的日期、接手本基金的时间、基金经理上任日期、管理人任职起始日、经理开始管这只基金的日期、任职开始日 |
                    | prodtSname | 基金简称 | 基金缩写名称、产品简称（基金）、基金简称、基金短名 |
                    | contractEffDate | 基金合同生效日 | 合同生效日期、基金成立生效日、基金合同开始日期、基金正式生效日 |
                    | fundMgrName | 基金管理人 | 管理机构、基金管理公司、管理人、负责管理的公司 |
                    | riskProfitCoeff | 风险收益特征 | 风险收益属性、基金风险与收益特点、风险和收益怎么样、风险收益情况 |
                    | rate | 收益率 | 
                    | maxWithDraw | 最大回撤 |         
                   \n
            """;
}
